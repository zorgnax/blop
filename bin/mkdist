#!/bin/bash

if ! [ -e .blop ]; then
    echo "must be run from blop top level directory"
    exit
fi
if [ -e blop ]; then
    echo "dist directory, blop/, already exists"
    exit
fi

mkdir blop
tar cf - . \
    --exclude ./blop.conf --exclude ./blop --exclude ./.git \
    --exclude './content/*/*' --exclude-tag .keep |
    tar xpf - -C blop
date +"%Y-%m-%d %H:%M:%S" > blop/.blop-build
tar czf blop.tar.gz blop
rm -rf blop
echo "created blop.tar.gz"

